let e;const t=new WeakMap,a=new WeakMap,o=a=>{if(!e)return;let o=t.get(a);if(!o){o=new Map;const i=new Set;return i.add(e),o.set("value",i),void t.set(a,o)}let i=o.get("value");if(!i)return i=new Set,i.add(e),o.set("value",i),void t.set(a,o);i.add(e)};function i(e,o,i,n){if(!a.get(e))return;const s=t.get(e);if(!s)return;let c=s.get(o);if(c)for(const e of c)e(i,n)}var n;!function(e){e.IS_REF="_isRef",e.IS_SHALLOW="_isShallow",e.IS_REACTIVE="_isReactive",e.IS_READONLY="_isReadonly"}(n||(n={}));class s{_isShallow=!1;_isRef=!0;_value;value;constructor(e,a=!1){const i=this;if(this._isShallow=a,e&&"object"==typeof e&&a){const t=m(e);this._value=t,this.value=e}else this._value=e,this.value=e;Object.defineProperty(this,"value",{get(){return o(this),i._value},set(e){const a=this._value;a!==e&&(i._value=e,function(e,a,o){const i=t.get(e);if(!i)return;let n=i.get("value");if(n)for(const e of n)e instanceof Function&&e(a,o)}(this,e,a))}})}toJSON(){return this._value}}const c=e=>!(!e||!e[n.IS_REF]),l=(e,t)=>new s(e,t),r=e=>c(e)?e.value:e,u=e=>c(e)?e:l(e,!0),d=e=>c(e)?e:l(e,!1),v=(o,i)=>function(s,l,r){if(l===n.IS_REACTIVE)return!o;if(l===n.IS_READONLY)return o;if(l===n.IS_SHALLOW)return i;const u=Reflect.get(s,l,r);return o||((o,i)=>{if(!e)return;if(!a.get(o))return;let n=t.get(o);if(!n){n=new Map;const a=new Set;return a.add(e),n.set(i,a),void t.set(o,n)}let s=n.get(i);if(!s)return s=new Set,s.add(e),n.set(i,s),void t.set(o,n);s.add(e)})(s,l),i?u:c(u)?u.value:u&&"object"==typeof u?u instanceof Element?u:o?y(u):m(u):u},g=(e,t)=>function(a,o,n,s){if(e)return!1;const l=a[o];if(h(l)&&c(l)&&!c(n))return!1;if(!t&&c(l)&&!c(n))return l.value=n,!0;const r=Reflect.set(a,o,n,s);return Array.isArray(a)&&"length"===o?(i(a,o,n,l),r):(l!==n&&i(a,o,n,l),r)},f=(e,t,o)=>{const i=a.get(e);if(i)return i;const n=new Proxy(e,((e,t)=>({get:v(e,t),set:g(e,t)}))(t,o));return a.set(e,n),n},h=e=>!(!e||!e[n.IS_READONLY]),p=e=>{return!(!(t=e)||!t[n.IS_REACTIVE])||h(e);var t},m=e=>(e=>f(e,!1,!1))(e),y=e=>(e=>f(e,!0,!1))(e),b=(t,a,i=!1)=>{if(i&&a(r(t),r(t)),Array.isArray(t)&&t.every((e=>c(e)))){for(const e in t)p(t[e])&&b(t[e],(()=>{const e=t.map((e=>r(e)));a(e,e)}));b((()=>t.map((e=>r(e)))),a)}else if(t instanceof Function)b(M(t),((e,t)=>{a(r(e),r(t))}));else{if(!p(t))return c(t)?(p(t.value)&&b(t.value,(()=>{a(r(t),r(t))})),e=a,o(t),void(e=void 0)):void 0;for(const o in t){e=()=>{a(t,t)};const i=t[o];e=void 0,b(i,(()=>{a(t,t)}))}}},_=t=>{e=t,t(),e=void 0},w=(e,t)=>{const a=d(t());return b(e,(()=>a.value=r(t()))),a},M=e=>{const t=d(void 0);return _((()=>t.value=r(e()))),t};function S(e,t,a,o,i){const n=u(!1),s=u(!1),c=u(!1),l=u(!1),{onCreated:r,beforeCreat:d,onMounted:v,beforeMount:g,beforeDestroy:f,onDestroyed:h}=i||{},p=e=>{const{onMounted:t,beforeMount:a,beforeDestroy:o,onDestroyed:i}=e;a&&b(n,(()=>{n.value&&a()}),!0),t&&b(s,(()=>{s.value&&t()}),!0),o&&b(c,(()=>{c.value&&o()}),!0),i&&b(l,(()=>{l.value&&i()}),!0)};d&&d();const m=document.createElement(e);k(m,t),A(m,a,p),C(m,o,p,(e=>{}));return r&&r(),{ele:m,beforeMount:()=>{n.value=!0,g&&g()},onMounted:()=>{s.value=!0,v&&v()},beforeDestroy:()=>{c.value=!0,f&&f()},onDestroyed:()=>{l.value=!0,h&&h()}}}function E(e,t,a,o,i){const n=u(!1),s=u(!1),c=u(!1),l=u(!1),{onCreated:r,beforeCreat:d,onMounted:v,beforeMount:g,beforeDestroy:f,onDestroyed:h}=i||{},p=e=>{const{onMounted:t,beforeMount:a,beforeDestroy:o,onDestroyed:i}=e;a&&b(n,(()=>{n.value&&a()}),!0),t&&b(s,(()=>{s.value&&t()}),!0),o&&b(c,(()=>{c.value&&o()}),!0),i&&b(l,(()=>{l.value&&i()}),!0)};d&&d();const m=document.createElementNS("http://www.w3.org/2000/svg",e);k(m,t),A(m,a,p),C(m,o,p,(e=>{}));return r&&r(),{ele:m,beforeMount:()=>{n.value=!0,g&&g()},onMounted:()=>{s.value=!0,v&&v()},beforeDestroy:()=>{c.value=!0,f&&f()},onDestroyed:()=>{l.value=!0,h&&h()}}}function k(e,t){for(const a in t)if(c(t[a])){const o=t[a];_((()=>e[a]=o.value))}else e[a]=t[a]}function A(e,t,a,o){if(t)for(const o in t)D(e,o,t[o],a)}function D(e,t,a,o,i){const n=t.toLowerCase();if(n.startsWith("on")){const[t]=n.match(/(?<=on).*/);if(t){const[o,...i]=t.split("_"),n=function(e){if(e.length)return{capture:e.includes("capture"),once:e.includes("once"),passive:e.includes("passive")}}(i);if(c(a)){const t=a,s=w(t,(()=>t.value?e=>{i.includes("prevent")&&e.preventDefault(),i.includes("stop")&&e.stopPropagation();(0,t.value)(e)}:void 0));return s.value&&e.addEventListener(o,s.value,n),void b(s,((t,a)=>{a&&e.removeEventListener(o,a),t&&e.addEventListener(o,t,n)}))}a instanceof Function&&e.addEventListener(o,a,n)}return}if(["checked","selected","disabled","enabled"].includes(n)){if(c(a)){const t=a;return void _((()=>{t.value?e.setAttribute(n,""):e.removeAttribute(n)}))}a?e.setAttribute(n,""):e.removeAttribute(n)}else if("ref"!==t)if(t.startsWith("xlink:")){const o="http://www.w3.org/1999/xlink";a?e.setAttributeNS(o,t,a):e.removeAttributeNS(o,t)}else if(t&&c(a)){const o=a;_((()=>{e.setAttribute(t,o.value)}))}else t&&e.setAttribute(t,a);else{if(c(a)){const t=a;return void(o&&o({onMounted(){t.value=e}}))}if(a instanceof Function){const t=a;return void(o&&o({onMounted(){t(e)}}))}}}function C(e,t,a,o){if(c(t)){const i=document.createComment("");if(b(t,(async(t,n)=>{if(t||!n)if(t){if(n){if(n instanceof Promise){const e=await n;e&&e.forEach((e=>{o&&o(e),e.beforeDestroy&&e.beforeDestroy()}))}n instanceof Promise||n.forEach((e=>{o&&o(e),e.beforeDestroy&&e.beforeDestroy()}))}if(t instanceof Promise){const o=await t;if(o){const t=o.map((e=>((e.beforeMount||e.onMounted)&&a&&a(e),e.ele)));e.replaceChildren(x(t))}return}const i=t.map((e=>((e.beforeMount||e.onMounted)&&a&&a(e),e.ele)));if(e.replaceChildren(x(i)),n){if(n instanceof Promise){const e=await n;e&&e.forEach((e=>{e.onDestroyed&&e.onDestroyed()}))}n instanceof Promise||n.forEach((e=>{e.onDestroyed&&e.onDestroyed()}))}}else;else{if(n instanceof Promise){const e=await n;e&&e.forEach((e=>{o&&o(e),e.beforeDestroy&&e.beforeDestroy()}))}if(n instanceof Promise||n.forEach((e=>{o&&o(e),e.beforeDestroy&&e.beforeDestroy()})),e.replaceChildren(i),n instanceof Promise){const e=await n;e&&e.forEach((e=>{e.onDestroyed&&e.onDestroyed()}))}n instanceof Promise||n.forEach((e=>{e.onDestroyed&&e.onDestroyed()}))}})),t.value instanceof Promise)return e.appendChild(i),void t.value.then((t=>{if(t){const o=t.map((e=>((e.beforeMount||e.onMounted)&&a&&a(e),e.ele)));e.replaceChildren(x(o))}}));if(t.value){const o=t.value.map((e=>((e.beforeMount||e.onMounted)&&a&&a(e),e.ele)));return void e.appendChild(x(o))}e.appendChild(i)}else{if(t instanceof Promise){const o=document.createComment("");return e.appendChild(o),void t.then((e=>{if(e){const{beforeMount:t,onMounted:i}=e;(t||i)&&a&&a(e),o.replaceWith(e.ele)}}))}if(Array.isArray(t)){const i=[];for(const e in t){const n=t[e];if(c(n)){const t=document.createComment("");if(b(n,(async(e,i)=>{if(e||!i)if(!e||i){if(e&&i){if(e instanceof Promise&&i instanceof Promise){return void I(await e,await i,t,a,o)}if(e instanceof Promise&&!(i instanceof Promise)){return void I(await e,i,t,a,o)}if(!(e instanceof Promise)&&i instanceof Promise){return void I(e,await i,t,a,o)}if(!(i instanceof Promise||e instanceof Promise))return void I(e,i,t,a,o)}}else{if(e instanceof Promise){const n=await e;return void(n&&I(n,i,t,a,o))}I(e,i,t,a,o)}else{if(i instanceof Promise){const n=await i;return void(n&&I(e,n,t,a,o))}I(e,i,t,a,o)}})),n.value instanceof Promise){i[e]={ele:t},n.value.then((e=>{if(e){const{beforeMount:o,onMounted:i}=e;(o||i)&&a&&a(e),t.replaceWith(e.ele)}}));continue}if(n.value){const{beforeMount:t,onMounted:a,ele:o}=n.value;i[e]={ele:o,beforeMount:t,onMounted:a};continue}i[e]={ele:t}}else if(n instanceof Promise){const t=document.createComment("");i[e]={ele:t},n.then((e=>{if(e){const{beforeMount:o,onMounted:i}=e;(o||i)&&a&&a(e),t.replaceWith(e.ele)}}))}else if(n){const{beforeMount:t,onMounted:a,ele:o}=n;i[e]={ele:o,beforeMount:t,onMounted:a}}}const n=i.map((e=>((e.beforeMount||e.onMounted)&&a&&a(e),e.ele)));e.appendChild(x(n))}else if(t){const{beforeMount:o,onMounted:i}=t;return(o||i)&&a&&a(t),void e.appendChild(t.ele)}}}function I(e,t,a,o,i){if(e&&t){const{beforeMount:a,onMounted:i}=e;return(a||i)&&o&&o(e),t.beforeDestroy&&t.beforeDestroy(),t.ele.replaceWith(e.ele),void(t.onDestroyed&&t.onDestroyed())}if(e&&!t){const{beforeMount:t,onMounted:i}=e;return(t||i)&&o&&o(e),void a.replaceWith(e.ele)}if(!e&&t)return i&&i(t),t.beforeDestroy&&t.beforeDestroy(),t.ele.replaceWith(a),void(t.onDestroyed&&t.onDestroyed())}function R(e,t){const{onCreated:a,beforeCreat:o,onMounted:i,beforeMount:n,onDestroyed:s,beforeDestroy:l}=t||{};if(o&&o(),c(e)){const t=e,o=document.createTextNode("");return _((()=>{o.data=t.value})),a&&a(),{ele:o,beforeMount:n,onMounted:i,onDestroyed:s,beforeDestroy:l}}return a&&a(),{ele:document.createTextNode(String(e)),beforeMount:n,onMounted:i,beforeDestroy:l,onDestroyed:s}}async function T(e,t=document.body){if(e instanceof Promise){const{ele:a,beforeMount:o,onMounted:i}=await e;return void(a&&t&&(o&&o(),t.appendChild(a),i&&i()))}const{ele:a,beforeMount:o,onMounted:i}=e;a&&t&&(o&&o(),t.appendChild(a),i&&i())}function x(e){const t=document.createDocumentFragment();for(const a in e)t.appendChild(e[a]);return t}const P={version:"1.0.0",name:"tech-study-plugin"};function L(e,t){let a=-1;return function(...o){-1!==a&&clearTimeout(a),a=setTimeout((()=>{e.apply(this,o)}),t)}}function W(e=0,t){let a=e,o=-1,i=!1;return{wait:()=>new Promise((e=>{o=setInterval((async()=>(t&&await t(a,i),i||a<=0?(clearInterval(o),void e(void 0)):void a--)),1e3)})),cancel(){a<=0||(i=!0)}}}function H(e,t){return new Promise((a=>{const o=setInterval((async()=>{await e()&&(t&&clearTimeout(i),clearInterval(o),a(!0))}),500);if(!t)return;const i=setTimeout((()=>{clearInterval(o),a(!1)}),t)}))}function N(e){const t=Math.random().toString(32).slice(2,e).padEnd(e,"0");return e<=8?t:`${t}${N(e-8)}`}function O({paths:e,viewBox:t="0 0 1024 1024"}){return E("svg",void 0,{viewBox:t,class:"egg_icon"},e.map((e=>E("path",void 0,{d:e}))))}class ${id;title;message;type;active=!1;destroyed=!1;mounted=!1;removed=!1;keep;delay;constructor(e){const t=N(8);this.id=t;const{title:a,message:o,type:i,delay:n,keep:s}=e;this.title=a,this.message=o,this.type=i,this.delay=n||2e3,this.keep=s||!1}show(){return this.active=!0,this.keep||setInterval((()=>{this.destroy()}),this.delay),this}async destroy(){if(!this.destroyed){this.active=!1,this.destroyed=!0;let e=setInterval((async()=>{const t=z.filter((e=>e.destroy));if(t[0].removed||t[0].id===this.id&&this.mounted){clearInterval(e),await function(e){let t=Number(e);return Number.isInteger(t)||(t=1e3),new Promise((e=>{setTimeout((()=>{e()}),t)}))}(300);const t=z.findIndex((e=>e.id===this.id));z.splice(t,1)}}),300)}}update(e){const t=z.find((e=>e.id===this.id));if(t){const{title:a,message:o}=e;void 0!==a&&(t.title=a),void 0!==o&&(t.message=o)}return this}}const z=m([]);const U=()=>({create(e){const t=new $(e);return z.push(t),t},clear(){z.forEach((e=>e.destroy()))}}),V="https://www.xuexi.cn/";async function F(){const e=await chrome.windows.getCurrent(),t=e.id,a=u(e.height),o=u(e.width),i=u(e.left),n=u(e.top),s=u(e.focused),c=u(e.state);return b(a,(()=>{chrome.windows.update(t,{height:a.value})})),b(o,(()=>{chrome.windows.update(t,{width:o.value})})),b(i,(()=>{chrome.windows.update(t,{left:i.value})})),b(n,(()=>{chrome.windows.update(t,{top:n.value})})),b(s,(()=>{chrome.windows.update(t,{focused:s.value})})),b(c,(()=>{chrome.windows.update(t,{state:c.value})})),{height:a,width:o,left:i,top:n,focused:s,state:c}}var G,B,j,X;!function(e){e[e.VIDEO_MUTED=0]="VIDEO_MUTED",e[e.RANDOM_EXAM=1]="RANDOM_EXAM",e[e.AUTO_ANSWER=2]="AUTO_ANSWER",e[e.REMOTE_PUSH=3]="REMOTE_PUSH"}(G||(G={})),function(e){e[e.LOGIN=0]="LOGIN",e[e.READ=1]="READ",e[e.WATCH=2]="WATCH",e[e.PRACTICE=3]="PRACTICE"}(B||(B={})),function(e){e[e.LOADING=0]="LOADING",e[e.START=1]="START",e[e.PROGRESS=2]="PROGRESS",e[e.PAUSE=3]="PAUSE",e[e.FINISH=4]="FINISH"}(j||(j={})),function(e){e[e.READ=0]="READ",e[e.WATCH=1]="WATCH"}(X||(X={}));const Y=(e,t,a)=>{const{once:o}=a||{},i=(a,i)=>{if(e===a)return t(a,i),void(o&&n())},n=()=>{chrome.tabs.onRemoved.removeListener(i)};return chrome.tabs.onRemoved.addListener(i),n},{notify:q}=(()=>{let e=[];const t=L((()=>{const t=e;chrome.notifications.create({iconUrl:"../assets/icon.jpg",title:"提示",message:"",items:t.map((({message:e,title:t})=>({message:e,title:t}))),type:"list"}),e=[]}),500);return{notify(a){if(void 0!==a.id){const t=e.findIndex((e=>void 0!==e.id&&e.id===a.id));t+1&&e.splice(t,1)}e.push(a),t()}}})(),J={tabId:u(0),login:u(!1),themeColor:u("#056de8"),settings:m([!0,!0]),taskConfig:m([{title:"登录",currentScore:0,dayMaxScore:0,need:0,status:!1,tip:"每日首次登录积1分。",active:!0,disabled:!0,type:B.LOGIN},{title:"文章选读",currentScore:0,dayMaxScore:0,need:0,status:!1,tip:"每有效阅读一篇文章积1分，上限6分。有效阅读文章累计1分钟积1分，上限6分。每日上限积12分。",active:!0,disabled:!1,type:B.READ},{title:"视听学习",currentScore:0,dayMaxScore:0,need:0,status:!1,tip:"每有效一个音频或观看一个视频积1分，上限6分。有效收听音频或观看视频累计1分钟积1分，上限6分。每日上限积12分。",active:!0,disabled:!1,type:B.WATCH},{title:"每日答题",currentScore:0,dayMaxScore:0,need:0,status:!1,tip:"每组答题每答对1道积1分。每日上限积5分。",active:!1,disabled:!0,type:B.PRACTICE}]),isBlack:u(!1),todayScore:u(0),totalScore:u(0),maxRead:u(80),maxWatch:u(100),message:u(""),pushToken:u(""),userInfo:u(null),notify:q};function K(e){return e<10?`0${e}`:`${e}`}function Z(...e){ee("dodgerblue",...e)}function Q(...e){ee("red",...e)}function ee(e,...t){const a=t.map((e=>!(e instanceof Function)&&e instanceof Object?e instanceof Error?e.stack:JSON.stringify(e):String(e))).join(" ");console.log(`%c[${function(e=Date.now()){const t=new Date(e),a=t.getSeconds(),o=t.getMinutes(),i=t.getHours(),n=t.getDate(),s=t.getMonth()+1;return`${[t.getFullYear(),s,n].map(K).join("-")} ${[i,o,a].map(K).join(":")}`}()}] %c${a}`,"",`color: ${e}`)}async function te(e,t){const{data:a,type:o}=t;return"tab"===o?await chrome.tabs.sendMessage(t.id,{data:a,action:e}):"runtime"===o?await chrome.runtime.sendMessage({data:a,action:e}):void 0}function ae(e,t,a){const{once:o}=a||{},i=(a,i,s)=>{const{action:c,data:l}=a;if(c&&e===c)return t(l,i,s),void(o&&n())},n=()=>{chrome.runtime.onMessage.removeListener(i)};return chrome.runtime.onMessage.addListener(i),n}function oe(e,t){return new Promise((async(a,o)=>{const i=setTimeout((()=>{n(),o("请求超时!")}),t.timeout||6e3),n=ae(e,(e=>{clearTimeout(i),n(),a(e)}));try{await te(e,t)}catch(e){o(e)}}))}const ie=()=>chrome.storage.local,ne=(e,t)=>{const a="object"==typeof t?JSON.parse(JSON.stringify(t)):t;return ie().set({[e]:a})},se=async e=>(await ie().get(e))[e],ce=(e,t,a)=>{const{once:o}=a||{},i=ie();let n=!1;const s=a=>{if(e in a){const{newValue:i,oldValue:n}=a[e];t(i,n),o&&c()}},c=()=>{n||(n=!0,i.onChanged.removeListener(s))};return i.onChanged.addListener(s),c};function le({text:e}){return S("div",void 0,{class:"egg_hr_wrap"},[S("div",void 0,{class:"egg_hr"}),S("div",void 0,{class:"egg_hr_title"},R(e)),S("div",void 0,{class:"egg_hr"})])}function re(){const{login:e,tabId:t}=J,a=u(!1),o=u(""),{addListener:i,removeAllListeners:n}=function(){const e=[];return{listeners:e,addListener(t,a,o){const i=N(8);e.push({id:i,action:t,callback:a,cancel:ae(t,a,o)})},removeAllListeners(){for(;;){const t=e.pop();if(!t)break;t.cancel()}},removeListener(t){const a=e.findIndex((e=>e.id===t));-1!==a&&(e[a].cancel(),e.splice(a,1))}}}();return S("div",void 0,{class:"egg_login_item"},[S("button",void 0,{type:"button",class:"egg_login_btn",onclick:L((()=>{te("login",{type:"tab",id:t.value,data:null})}),300)},R(M((()=>a.value?"刷新二维码":"扫码登录")))),S("div",void 0,{class:M((()=>"egg_login_img_wrap"+(a.value?" active":"")))},S("img",void 0,{class:"egg_login_img",src:o}))],{onMounted(){i("qrcode",(async e=>{const{src:i,revoked:n}=e;if(n)return void te("login",{type:"tab",id:t.value,data:null});(await F()).height.value=810,o.value=i,a.value=!0})),i("login",(async t=>{a.value=!1,o.value="",e.value=t;(await F()).height.value=700}))},beforeDestroy(){n()}})}function ue({tip:e}){return S("button",void 0,{type:"button",class:"egg_detail",title:e},R("i"))}function de({tip:e="",checked:t=!1,disabled:a=!1,onchange:o}){return S("input",{checked:t},{title:e,class:"egg_switch",type:"checkbox",disabled:a,onchange:o})}function ve({show:e}){const{taskConfig:t,todayScore:a}=J;return S("div",void 0,{class:M((()=>"egg_score_panel"+(e.value?" active":"")))},[S("div",void 0,{class:"egg_score_title"},[O({paths:["M314.81 304.01h415.86v58.91H314.81zM314.81 440.24h415.86v58.91H314.81z","M814.8 892.74h-8.64l-283.51-182-283.51 182h-8.64A69.85 69.85 0 0 1 160.72 823V188.22a69.85 69.85 0 0 1 69.77-69.77H814.8a69.85 69.85 0 0 1 69.77 69.77V823a69.85 69.85 0 0 1-69.77 69.74zM230.5 177.35a10.87 10.87 0 0 0-10.86 10.86V823a10.86 10.86 0 0 0 5 9.11l298.01-191.42 298.06 191.38a10.86 10.86 0 0 0 5-9.11V188.22a10.87 10.87 0 0 0-10.86-10.86z"]}),S("div",void 0,{class:"egg_score_title_text"},R("积分详情"))]),...t.map((e=>S("div",void 0,{class:"egg_score_detail_item"},[R(e.title),S("span",void 0,void 0,R(M((()=>e.currentScore))))]))),S("div",void 0,{class:"egg_score_detail_item"},[R("其他"),S("span",void 0,void 0,R(M((()=>a.value-t.reduce(((e,t)=>e+t.currentScore),0)))))])])}function ge(){const{todayScore:e,totalScore:t,login:a}=J,o=u(!1);return S("div",void 0,{class:"egg_score_item"},S("div",void 0,{class:"egg_scoreinfo"},[S("div",void 0,{class:"egg_total_score"},[R("总积分"),S("span",void 0,void 0,R(t))]),S("button",void 0,{class:"egg_today_score",type:"button",onclick:L((()=>{o.value=!o.value}),300),onblur(){o.value=!1}},[R("当天分数"),S("span",void 0,void 0,R(e)),O({paths:["M332.16 883.84a40.96 40.96 0 0 0 58.24 0l338.56-343.04a40.96 40.96 0 0 0 0-58.24L390.4 140.16a40.96 40.96 0 0 0-58.24 58.24L640 512l-307.84 314.24a40.96 40.96 0 0 0 0 57.6z"]}),ve({show:o})])]),{onMounted(){_((()=>{a.value||(e.value=0,t.value=0)}))}})}function fe({data:e,maxlength:t,placeholder:a="",onchange:o,value:i,keep:n}){const s=m(e.map((e=>({selected:!1,active:!1,ele:null,...e})))),c=i?.value?M((()=>i.value)):u(null),l=M((()=>s.find((e=>e.value===c.value))?.label||null)),r=u(!1),d=u(l),v=u(0);return b((()=>s.map((e=>[e.active,e.selected]))),(()=>s.forEach((e=>(e.selected||e.active)&&(v.value=e.ele?.offsetTop||0))))),S("div",void 0,{class:"egg_select"},[S("input",{value:d},{class:"egg_select_input",type:"text",placeholder:a,maxlength:t,onfocus(){if(r.value=!0,c.value){const e=s.findIndex((e=>e.value===c.value));e+1&&(d.value=s[e].label,s.forEach(((t,a)=>t.selected=a===e)))}},oninput(e){const t=e.target;d.value=t.value;const a=s.findIndex((e=>e.label.includes(t.value)));d.value?a+1&&s.forEach(((e,t)=>{e.active=t===a,e.active&&setTimeout((()=>{e.active=!1}),100)})):(s.forEach((e=>e.active=e.selected=!1)),v.value=0)},onblur(){if(n){const e=s.find((e=>e.value===c.value));d.value=e?.label||null}setTimeout((()=>{r.value=!1}),100)}}),S("div",{scrollTop:v},{class:M((()=>"egg_select_list"+(r.value?" active":"")))},s.map(((e,t)=>S("button",void 0,{type:"button",class:w((()=>[e.selected,e.active]),(()=>"egg_select_item"+(e.selected?" selected":e.active?" active":""))),ref:t=>e.ele=t,onclick(){d.value!==e.label&&(d.value=e.label,s.forEach(((e,a)=>e.selected=a===t)),o&&o({label:e.label,value:e.value})),r.value=!1}},R(e.label)))))])}function he({settingsShow:e,themeColor:t,settings:a}){const o=[{value:"#fa3333",title:"强国红",detail:"XueXi Red",code:"none"},{value:"#bb2649",title:"非凡洋红",detail:"Viva Magenta",code:"18-1750"},{value:"#35548a",title:"经典蓝",detail:"Classic Blue",code:"19-4052"},{value:"#f36f63",title:"活珊瑚橘",detail:"Living Coral",code:"16-1546"},{value:"#6d5b97",title:"紫外光色",detail:"Ultra Violet",code:"18-3838"},{value:"#86af49",title:"草木绿",detail:"Greenery",code:"15-0343"},{value:"#fc8bab",title:"B站粉",detail:"Bilibili Pink",code:"none"},{value:"#056de8",title:"知乎蓝",detail:"Zhihu Blue",code:"none"}],{maxRead:i,maxWatch:n,pushToken:s,notify:c}=J,l=M((()=>s.value||null));return S("div",void 0,{class:M((()=>"egg_settings_panel_wrap"+(e.value?" active":"")))},S("div",void 0,{class:"egg_settings_panel"},[S("div",void 0,{class:"egg_back_wrap"},[S("button",void 0,{class:"egg_btn",title:"返回",type:"button",onclick:L((()=>{e.value=!1}),300)},O({paths:["M942.545455 478.021818H165.748364l361.239272-361.192727a34.909091 34.909091 0 1 0-49.384727-49.384727L56.785455 488.261818a33.838545 33.838545 0 0 0-7.493819 11.264 34.536727 34.536727 0 0 0 7.493819 38.120727l420.817454 420.817455a34.816 34.816 0 0 0 49.338182 0 34.909091 34.909091 0 0 0 0-49.384727l-361.239273-361.192728h776.843637a34.909091 34.909091 0 0 0 0-69.864727z"]})),R("设置")]),S("div",void 0,{class:"egg_settings_content"},[S("div",void 0,{class:"egg_settings_version_wrap"},[S("div",void 0,{class:"egg_settings_label"},R("版本信息")),S("div",void 0,{class:"egg_settings_version"},[R(`v${P.version}`),S("button",void 0,{type:"button",class:"egg_settings_version_detail",title:"GitHub Xu22Web/tech-study-plugin",onclick(){chrome.tabs.create({url:"https://github.com/Xu22Web/tech-study-plugin",active:!0})}},O({paths:["M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"],viewBox:"0 0 16 16"}))])]),S("div",void 0,{class:"egg_settings_theme_wrap"},[S("div",void 0,{class:"egg_settings_title"},[S("div",void 0,{class:"egg_settings_label"},R("主题预设")),S("div",void 0,{class:"egg_settings_current_theme"},R(M((()=>o.find((e=>e.value===t.value)).title))))]),S("div",void 0,{class:"egg_settings_theme_colors"},o.map((e=>S("div",void 0,{class:"egg_settings_theme_color_wrap",style:`--color: ${e.value}`},S("button",void 0,{class:M((()=>"egg_settings_theme_color"+(t.value===e.value?" active":""))),type:"button",title:e.title,onclick:L((()=>{t.value!==e.value&&(t.value=e.value,ne("themeColor",t),c({title:"主题设置",message:`主题色已保存为${e.title}`}))}),300)})))))]),S("div",void 0,{class:"egg_settings_read_time_wrap"},[S("div",void 0,{class:"egg_settings_label"},R("最大文章时长")),fe({data:[{label:"40s",value:40},{label:"60s",value:60},{label:"80s",value:80},{label:"100s",value:100}],value:i,placeholder:"100s",maxlength:4,keep:!0,onchange({value:e}){i.value=e,ne("maxRead",i),c({title:"时间设置",message:`最大文章选读时间改为${e}s`})}})]),S("div",void 0,{class:"egg_settings_watch_time_wrap"},[S("div",void 0,{class:"egg_settings_label"},R("最大视听时长")),fe({data:[{label:"40s",value:40},{label:"60s",value:60},{label:"80s",value:80},{label:"100s",value:100},{label:"120s",value:120}],value:n,placeholder:"120s",maxlength:4,keep:!0,onchange({value:e}){n.value=e,ne("maxWatch",n),c({title:"时间设置",message:`最大视听学习时间改为${e}s`})}})]),M((()=>a[G.REMOTE_PUSH]?S("div",void 0,{class:"egg_settings_token_wrap"},[S("div",void 0,{class:"egg_settings_token"},[S("div",void 0,{class:"egg_settings_label"},R("我的 token")),S("div",void 0,{class:"egg_settings_token_input_wrap"},S("input",{value:l},{class:"egg_settings_token_input",type:"text",placeholder:"token",maxlength:32,pattern:"^[0-9a-z]{32}$",required:!0,oninput(e){const t=e.target;l.value=t.value},onblur(){if(null!==l.value){if(/^[0-9a-z]{32}$/.test(l.value))return void(s.value!==l.value&&(s.value=l.value,ne("pushToken",s),c({title:"推送设置",message:"token 保存成功!"})));if(""===l.value)return s.value="",l.value=null,ne("pushToken",s),void c({title:"推送设置",message:"token 删除成功!"});l.value=s.value,c({title:"推送设置",message:"token 有误!"})}}}))])]):void 0))])]))}async function pe(e,t){await chrome.debugger.sendCommand({tabId:e},"Input.dispatchMouseEvent",t)}async function me(e,t){await chrome.debugger.sendCommand({tabId:e},"Input.dispatchKeyEvent",t)}async function ye(e,t){await chrome.debugger.sendCommand({tabId:e},"Input.dispatchTouchEvent",t)}function be(e){return{dispatchKeyEvent:t=>me(e,t),dispatchKeyPressEvent:t=>async function(e,t){await me(e,{type:"keyDown",...t}),await me(e,{type:"keyUp",...t})}(e,t),dispatchKeyInputEvent:t=>async function(e,t){for(const a of t)await me(e,{type:"char",...a})}(e,t),dispatchMouseClickEvent:t=>async function(e,t){await pe(e,{type:"mousePressed",...t}),await pe(e,{type:"mouseReleased",...t})}(e,t),dispatchMouseEvent:t=>pe(e,t),dispatchMouseMoveEvent:t=>async function(e,t){await pe(e,{type:"mouseMoved",...t})}(e,t),dispatchMouseWheelEvent:t=>async function(e,t){"up"!==t.direction?"down"!==t.direction||await pe(e,{type:"mouseWheel",deltaX:-0,deltaY:100,...t}):await pe(e,{type:"mouseWheel",deltaX:-0,deltaY:-100,...t})}(e,t),dispatchMouseSlideEvent:t=>async function(e,t){await pe(e,{type:"mousePressed",...t[0]});for(const a of t)await pe(e,{type:"mouseMoved",...a});await pe(e,{type:"mouseReleased",...t[t.length-1]})}(e,t),dispatchTouchSlideEvent:t=>async function(e,t){await ye(e,{type:"touchStart",...t[0]});for(const a of t)await ye(e,{type:"touchMove",...a});await ye(e,{type:"touchEnd",...t[t.length-1]})}(e,t),dispatchTouchTapEvent:t=>async function(e,t){await ye(e,{type:"touchStart",...t}),await ye(e,{type:"touchEnd",...t})}(e,t),dispatchTouchEvent:t=>ye(e,t)}}function _e(e){const{x:t,y:a,width:o,height:i}=e;return{x:t+Math.random()*o*.5+.25*o,y:a+Math.random()*i*.5+.25*i}}function we(){const{taskConfig:e,todayScore:t,totalScore:a,tabId:o,maxRead:i,maxWatch:n,settings:s,isBlack:c,userInfo:l}=J,r=U(),d=u(j.START),v=u(!1),g=()=>e.every((e=>!e.active||e.active&&e.status)),f=async()=>{Z("获取任务进度...");try{const t=await oe("getTaskProgress",{type:"tab",id:o.value,data:null});if(t){const{taskProgress:a,inBlackList:o}=t;return a.forEach(((t,a)=>{e[a].currentScore=t.currentScore,e[a].dayMaxScore=t.dayMaxScore,e[a].status=t.status,e[a].need=t.need})),c.value=o,void Z("获取任务进度成功!")}}catch(e){}Q("获取任务进度失败!")},h=async()=>{Z("获取总分...");try{const e=await oe("getTotalScore",{type:"tab",id:o.value,data:null});if(e)return a.value=e,void Z("获取总分成功!")}catch(e){}Q("获取总分失败!")},p=async()=>{Z("获取当天分数...");try{const e=await oe("getTodayScore",{type:"tab",id:o.value,data:null});if(e)return t.value=e,void Z("获取当天分数成功!")}catch(e){}Q("获取当天分数失败!")},m=()=>Promise.all([f(),p(),h()]),y=async()=>{await H((()=>(v.value&&Z("等待中..."),!v.value)));try{const t=await oe("getNews",{type:"tab",id:o.value,data:e[B.READ].need}),a=await F();for(const o in t){Z(`阅读第${Number(o)+1}篇文章`),r.create({title:"文章选读",type:"info",message:`阅读第 ${Number(o)+1} 篇文章`}),await H((()=>(v.value&&Z("等待中..."),!v.value)));const n=await chrome.tabs.create({url:t[o].url,active:!0}),s=n.id;await chrome.tabs.update(s,{autoDiscardable:!1});let c=!1;a.height.value=720,await chrome.debugger.attach({tabId:s},"1.3");try{if(!await H((async()=>{try{return await oe("load",{type:"tab",id:s})}catch(e){return!1}}),6e3))throw Q("页面加载失败!"),r.create({title:"文章选读",type:"fail",message:"页面加载失败!"}),new Error("页面加载失败!");const{dispatchMouseWheelEvent:e}=be(s);Z("页面加载成功!");const t=await oe("getData",{type:"tab",data:{max:i.value,type:X.READ},id:n.id});if(!t)throw Q("获取页面信息失败!"),r.create({title:"文章选读",type:"fail",message:"获取页面信息失败!"}),new Error("获取页面信息失败!");const{height:a,duration:o,innerWidth:l,innerHeight:u}=t,d=_e({x:0,y:0,width:l,height:u}),g=~~(12*a/(120*o)),f=r.create({title:"文章选读",message:"开始倒计时",type:"info",keep:!0}),{wait:h,cancel:p}=W(o,(async(t,a)=>{if(await H((()=>(v.value&&Z("等待中..."),!v.value))),Z(`剩余${t}s`),f.update({message:`时间剩余 ${t} s`}),(a||t<=0)&&f.destroy(),t&&t%12==0){let t=g;for(;t--;)await e({direction:"down",...d})}}));ae("unload",(async()=>{c||(p(),Z("刷新标签页, 取消倒计时"))}),{once:!0}),Y(s,(()=>{c=!0,p(),Z("关闭标签页, 取消倒计时")}),{once:!0}),await h()}catch(e){Q(e)}if(c||(await chrome.debugger.detach({tabId:s}),a.height.value=700,c=!0,await chrome.tabs.remove(s)),await m(),!e[B.READ].active||e[B.READ].active&&e[B.READ].status)break}}catch(e){Q("获取新闻失败!",e),r.create({title:"文章选读",type:"fail",message:"获取新闻失败!"})}await H((()=>(v.value&&Z("等待中..."),!v.value))),e[B.READ].active&&!e[B.READ].status&&await y()},E=async()=>{await H((()=>(v.value&&Z("等待中..."),!v.value)));try{const t=await oe("getVideos",{type:"tab",id:o.value,data:e[B.WATCH].need}),a=await F();for(const o in t){Z(`观看第${Number(o)+1}个视频`),r.create({title:"视听学习",type:"info",message:`观看第 ${Number(o)+1} 个视频`}),await H((()=>(v.value&&Z("等待中..."),!v.value)));const i=(await chrome.tabs.create({url:t[o].url,active:!0})).id;await chrome.tabs.update(i,{autoDiscardable:!1});let c=!1;a.height.value=720,await chrome.debugger.attach({tabId:i},"1.3");try{if(!await H((async()=>{try{return await oe("load",{type:"tab",id:i})}catch(e){return!1}}),6e3))throw Q("页面加载失败!"),r.create({title:"视听学习",type:"fail",message:"页面加载失败!"}),new Error("页面加载失败!");Z("页面加载成功!");const{dispatchMouseWheelEvent:e,dispatchMouseClickEvent:t}=be(i),a=await oe("getData",{type:"tab",data:{max:n.value,type:X.WATCH},id:i});if(!a)throw Q("获取页面信息失败!"),r.create({title:"视听学习",type:"fail",message:"获取页面信息失败!"}),new Error("获取页面信息失败!");_((()=>{!c&&te("muted",{type:"tab",id:i,data:s[G.VIDEO_MUTED]})})),_((()=>{!c&&te("pause",{type:"tab",id:i,data:v.value})}));const{duration:o,innerWidth:l,innerHeight:u}=a,d=_e({x:0,y:0,width:l,height:u});let g=3;for(;g--;)await e({direction:"down",...d});await t({button:"left",clickCount:1,...d});if(!await H((async()=>{try{return await oe("play",{type:"tab",id:i})}catch(e){return!1}}),1e4))throw Q("视频播放失败!"),r.create({title:"视听学习",type:"fail",message:"视频播放失败!"}),new Error("视频播放失败!");Z("视频播放成功!");const f=r.create({title:"视听学习",message:"开始倒计时",type:"info",keep:!0}),{wait:h,cancel:p}=W(o,(async(e,t)=>{await H((()=>(v.value&&Z("等待中..."),!v.value))),Z(`剩余${e}s`),f.update({message:`时间剩余 ${e} s`}),(t||e<=0)&&f.destroy()}));ae("unload",(async()=>{c||(p(),Z("刷新标签页, 取消倒计时"))}),{once:!0}),Y(i,(()=>{c=!0,p(),Z("关闭标签页, 取消倒计时")}),{once:!0}),await h()}catch(e){Q(e)}if(c||(await chrome.debugger.detach({tabId:i}),a.height.value=700,c=!0,await chrome.tabs.remove(i)),await m(),!e[B.WATCH].active||e[B.WATCH].active&&e[B.WATCH].status)break}}catch(e){Q("获取视频失败!",e),r.create({title:"视听学习",type:"fail",message:"获取视频失败!"})}await H((()=>(v.value&&Z("等待中..."),!v.value))),e[B.WATCH].active&&!e[B.WATCH].status&&await E()},k=async()=>{d.value=j.PROGRESS,e[B.READ].active&&!e[B.READ].status&&await y(),e[B.WATCH].active&&!e[B.WATCH].status&&await E(),g()&&(d.value=j.FINISH)},A=()=>{d.value=j.PAUSE,v.value=!0},D=()=>{d.value=j.PROGRESS,v.value=!1};return S("div",void 0,{class:"egg_study_item"},S("button",void 0,{class:M((()=>"egg_study_btn"+(d.value===j.PROGRESS?" loading":""))),type:"button",disabled:w(d,(()=>d.value===j.LOADING||d.value===j.FINISH)),onclick:M((()=>d.value===j.START?L(k,300):d.value===j.PROGRESS?L(A,300):d.value===j.PAUSE?L(D,300):void 0))},R(M((()=>""+(d.value===j.LOADING?"等待中":d.value===j.START?"开始学习":d.value===j.PROGRESS?"正在学习, 点击暂停":d.value===j.PAUSE?"继续学习":d.value===j.FINISH?"已完成":""))))),{async onMounted(){await(async()=>{Z("获取用户信息...");try{const e=await oe("getUserInfo",{type:"tab",id:o.value});if(e)return l.value=e,void Z("获取用户信息成功!")}catch(e){}Q("获取用户信息失败!")})(),await m(),b((()=>e.map((e=>e.active))),(async()=>{if(d.value===j.LOADING||d.value===j.FINISH){if(g())return void(d.value=j.FINISH);d.value=j.START}}),!0)}})}function Me(){const{taskConfig:e,login:t,notify:a}=J;return S("div",void 0,{class:"egg_task_list"},e.map((t=>function({title:e,tip:t,checked:a,currentScore:o,dayMaxScore:i,onchange:n,disabled:s}){return S("div",void 0,{class:"egg_task_item"},[S("div",void 0,{class:"egg_label_wrap"},[S("div",void 0,{class:"egg_task_title_wrap"},[S("div",void 0,{class:"egg_task_title"},R(e)),S("div",void 0,{class:"egg_task_progress_wrap"},[S("div",void 0,{class:"egg_task_current"},R(o)),S("div",void 0,{class:"egg_task_max"},R(M((()=>`/${i.value}`))))])]),S("div",void 0,{class:"egg_progress"},[S("div",void 0,{class:"egg_track"},S("div",void 0,{class:"egg_bar",style:M((()=>`width: ${(100*o.value/i.value).toFixed(1)}%;`))}))])]),de({tip:t,checked:a,disabled:s,onchange:n})])}({title:t.title,tip:t.tip,checked:M((()=>t.active)),disabled:M((()=>t.disabled)),currentScore:M((()=>t.currentScore)),dayMaxScore:M((()=>t.dayMaxScore)),onchange:L((o=>{((t,o,i)=>{const{checked:n}=t.target;e[o].active!==n&&(e[o].active=n,ne("taskConfig",e),a({id:i,title:"任务设置",message:`${i} ${n?"打开":"关闭"}`}))})(o,t.type,t.title)}),300)}))),{onMounted(){_((()=>!t.value&&e.forEach((e=>{e.currentScore=0,e.dayMaxScore=0,e.status=!1}))))}})}T(S("div",void 0,{class:"egg_message_wrap"},w((()=>z.map((e=>e))),(()=>z.map((e=>S("div",void 0,{class:M((()=>"egg_message_item_wrap"+(e.active?" active":"")))},S("div",void 0,{class:"egg_message_item"},[S("div",void 0,{class:"egg_message_head_wrap"},[S("div",void 0,{class:M((()=>`egg_message_head ${e.type}`))},["info"===e.type||"warn"===e.type?O({paths:["M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"],viewBox:"64 64 896 896"}):"success"===e.type?O({paths:["M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"],viewBox:"64 64 896 896"}):O({paths:["M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm165.4 618.2l-66-.3L512 563.4l-99.3 118.4-66.1.3c-4.4 0-8-3.5-8-8 0-1.9.7-3.7 1.9-5.2l130.1-155L340.5 359a8.32 8.32 0 01-1.9-5.2c0-4.4 3.6-8 8-8l66.1.3L512 464.6l99.3-118.4 66-.3c4.4 0 8 3.5 8 8 0 1.9-.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z"],viewBox:"64 64 896 896"}),S("div",void 0,{class:"egg_message_title"},R(M((()=>e.title))))]),S("button",void 0,{type:"button",class:"egg_message_head_extra",onclick(){e.destroy()}},O({paths:["M579.392 511.296l429.376 428.544a48.128 48.128 0 0 1-34.176 82.304c-12.8 0-25.088-5.12-34.112-14.208L511.168 579.392 81.792 1008a48.32 48.32 0 0 1-67.648-0.576 48.128 48.128 0 0 1-0.64-67.52L442.88 511.296 13.568 82.752A48.128 48.128 0 0 1 14.08 15.168 48.32 48.32 0 0 1 81.792 14.592l429.376 428.544L940.48 14.592a48.32 48.32 0 0 1 67.648 0.64c18.624 18.56 18.88 48.64 0.64 67.52L579.392 511.296z"]}))]),S("div",void 0,{class:"egg_message_content"},R(M((()=>e.message))))],{beforeCreat(){e.destroyed||(e.active=e.mounted)},onMounted(){e.destroyed||e.mounted||(e.mounted=!0,e.active||requestAnimationFrame((()=>{e.show()})))}}),{onDestroyed(){e.mounted&&e.destroyed&&(e.removed=!0)}}))))))),T(async function(){const{tabId:e,login:t,themeColor:a,settings:o,taskConfig:i,maxRead:n,maxWatch:s,pushToken:c,notify:l}=J,r=u(!1),d=async()=>{const e=await se("taskConfig");try{e&&i.length===e.length&&i.forEach(((t,a)=>{t.active=e[a].active}))}catch(e){i.forEach((e=>{e.active=!0}))}},v=async()=>{const e=await se("settings");try{e&&o.length===e.length&&o.forEach(((t,a)=>o[a]=e[a]))}catch(e){o.fill(!1)}},g=async()=>{const e=await se("maxRead");e&&(n.value=e),ce("maxRead",(e=>{e&&(n.value=e)}))},f=async()=>{const e=await se("maxWatch");e&&(s.value=e),ce("newWatch",(e=>{e&&(s.value=e)}))},h=async()=>{const e=await se("pushToken");e&&(c.value=e)},p=async()=>{const e=await se("themeColor");e&&(a.value=e),ce("themeColor",(e=>{e&&(a.value=e)}))},m=async()=>{Z("被动断开连接!"),l({title:"连接提示",message:"已断开连接!"}),e.value=0,t.value=!1;(await F()).height.value=700},y=async()=>{const{value:e}=await chrome.cookies.get({url:V,name:"token"})||{};e&&(t.value=!0)};return await Promise.all([p(),d(),v(),g(),f(),h()]),(()=>{let t=!1,a=-1,o=-1;ae("connect",((e,i)=>{i.tab?.id&&(t?te("occupied",{type:"tab",id:i.tab.id,data:null}):(t||(t=!0,o=i.tab.id,a=setTimeout((()=>{t=!1,o=-1}),3e3)),Z("正在连接..."),te("connecting",{type:"tab",id:i.tab.id,data:null})))})),ae("connected",(async(i,n)=>{if(!n.tab?.id)return;if(n.tab.id!==o)return;clearTimeout(a),o=-1,Z("已连接!"),l({title:"连接提示",message:"已连接!"});const{id:s}=n.tab;e.value=s,await chrome.tabs.update(s,{autoDiscardable:!1}),y(),Y(s,(()=>{t=!1,m()}),{once:!0}),ae("disconnect",((e,a)=>{a.tab?.id&&s===a.tab.id&&(t=!1,m())}),{once:!0})}))})(),S("div",void 0,{class:"egg_panel",style:M((()=>`--themeColor: ${a.value}`))},[S("div",void 0,{class:"egg_tool_bar_wrap"},[S("div",void 0,{class:"egg_indicator_wrap"},[S("div",void 0,{class:M((()=>"egg_indicator"+(e.value?" active":"")))}),S("div",void 0,{class:"egg_indicator_status"},R(M((()=>e.value?" 已连接":"未连接"))))]),S("div",void 0,{class:"egg_feature_wrap"},[S("button",void 0,{class:"egg_btn",title:"重置",type:"button",onclick:L((()=>{i.forEach((e=>{!e.disabled&&(e.active=!0)})),o.fill(!1),n.value=80,s.value=100,a.value="#fa3333",c.value="",ie().clear()}),300)},O({paths:["M930.816609 339.889816V379.21591H90.455424v-39.326094h840.361185m9.363355-65.543491H81.092069c-31.016116 0-56.180135 28.558235-56.180135 63.787862v42.837353C24.911934 416.201166 50.075953 444.759401 81.092069 444.759401h859.087895c31.016116 0 56.180135-28.558235 56.180135-63.787861v-42.837353c0-35.229626-25.164019-63.787861-56.180135-63.787862z","M966.280319 1024h-0.234084l-906.255801-6.554349a33.122871 33.122871 0 0 1-24.929935-11.821237 32.771745 32.771745 0 0 1-7.139558-26.685564l98.549319-563.205852a32.771745 32.771745 0 1 1 64.490114 11.236027L98.999487 952.136244l827.954737 5.969139-95.974397-530.902274a32.771745 32.771745 0 0 1 64.490113-11.704195l103.113956 569.877243a32.888787 32.888787 0 0 1-32.303577 38.623843z","M283.69168 1001.996114a29.962739 29.962739 0 0 1-4.564636-0.351126 28.090067 28.090067 0 0 1-23.291347-32.186536l61.798148-380.854497a28.090067 28.090067 0 1 1 55.360841 9.01223L311.31358 978.470682a27.973025 27.973025 0 0 1-27.6219 23.525432zM566.1139 333.218425h-114.935193a32.771745 32.771745 0 0 1-32.771745-32.771745V90.239342a90.239342 90.239342 0 1 1 180.478683 0v210.207338a32.771745 32.771745 0 0 1-32.771745 32.771745z m-82.163448-65.543491h49.391702V90.239342a24.695851 24.695851 0 1 0-49.391702 0z"]})),S("button",void 0,{class:"egg_btn",title:"设置",type:"button",onclick:L((()=>{r.value=!0}),300)},O({paths:["M7.25325 705.466473a503.508932 503.508932 0 0 0 75.26742 121.391295 95.499302 95.499302 0 0 0 93.211173 31.07039 168.59902 168.59902 0 0 1 114.527206 16.257763 148.487566 148.487566 0 0 1 71.052444 83.456515 91.163899 91.163899 0 0 0 75.989987 61.538643 578.053784 578.053784 0 0 0 148.969278 0A91.163899 91.163899 0 0 0 662.380873 957.642436a148.487566 148.487566 0 0 1 72.256723-83.456515 168.59902 168.59902 0 0 1 114.406478-16.257763 95.61973 95.61973 0 0 0 93.331601-31.07039 503.508932 503.508932 0 0 0 75.267419-121.391295 84.29951 84.29951 0 0 0-18.545892-94.897163 138.251197 138.251197 0 0 1 0-197.140426 84.29951 84.29951 0 0 0 18.545892-94.897163 503.508932 503.508932 0 0 0-75.869559-121.391295 95.499302 95.499302 0 0 0-93.211173-31.070391A168.59902 168.59902 0 0 1 734.637596 149.812272a148.848849 148.848849 0 0 1-72.256723-83.456515A91.163899 91.163899 0 0 0 586.631741 4.817115a581.907476 581.907476 0 0 0-148.969277 0A91.163899 91.163899 0 0 0 361.311193 66.355757a148.848849 148.848849 0 0 1-71.413728 83.456515 168.59902 168.59902 0 0 1-114.406478 16.257763 95.378874 95.378874 0 0 0-93.3316 31.070391A503.508932 503.508932 0 0 0 7.25325 318.531721a84.29951 84.29951 0 0 0 18.545893 94.897163 140.057615 140.057615 0 0 1 41.30676 98.509999 140.057615 140.057615 0 0 1-41.30676 98.630427A84.29951 84.29951 0 0 0 7.25325 705.466473z m929.462315-349.240828a219.901294 219.901294 0 0 0 0 312.028615c0.842995 0.842995 2.649413 3.010697 1.806418 5.057971a427.398517 427.398517 0 0 1-63.104205 101.520696 9.513802 9.513802 0 0 1-9.032091 2.167702 255.547944 255.547944 0 0 0-173.777418 24.928569 231.823653 231.823653 0 0 0-111.275354 130.302957 6.984817 6.984817 0 0 1-6.021394 4.937543 492.790851 492.790851 0 0 1-126.328837 0 6.984817 6.984817 0 0 1-6.021394-4.937543 231.823653 231.823653 0 0 0-111.275353-130.302957 255.668372 255.668372 0 0 0-120.427872-30.468252 258.919924 258.919924 0 0 0-52.747408 5.539683 9.513802 9.513802 0 0 1-9.03209-2.167702 427.398517 427.398517 0 0 1-63.104205-101.520696c-0.842995-2.047274 0.963423-4.214976 1.806418-5.057971a221.82814 221.82814 0 0 0 64.910623-156.556233 221.707712 221.707712 0 0 0-65.512762-155.713238c-0.842995-0.842995-2.649413-3.010697-1.806418-5.057971a427.398517 427.398517 0 0 1 63.104205-101.520696 9.393374 9.393374 0 0 1 8.911662-2.167701 255.7888 255.7888 0 0 0 173.897847-24.92857 231.823653 231.823653 0 0 0 111.275353-130.302957 6.984817 6.984817 0 0 1 6.021394-4.937543 492.790851 492.790851 0 0 1 126.328837 0 6.984817 6.984817 0 0 1 6.021394 4.937543 231.823653 231.823653 0 0 0 111.275354 130.302957 255.547944 255.547944 0 0 0 173.777418 24.92857 9.513802 9.513802 0 0 1 9.032091 2.167701 423.063113 423.063113 0 0 1 62.983777 101.520696c0.963423 2.047274-0.842995 4.214976-1.68599 5.057971z","M512.086889 305.766366a206.292944 206.292944 0 1 0 206.172516 206.172517 206.413372 206.413372 0 0 0-206.172516-206.172517z m123.197713 206.172517a123.197713 123.197713 0 1 1-123.197713-123.077285 123.318141 123.318141 0 0 1 123.197713 123.077285z"]}))])]),w((()=>[e.value,t.value]),(()=>e.value&&!t.value?re():void 0)),w((()=>[e.value,t.value]),(()=>e.value&&t.value?function(){const{login:e,tabId:t,isBlack:a,userInfo:o}=J;return S("div",void 0,{class:"egg_user_item"},M((()=>o.value?[S("div",void 0,{class:"egg_userinfo"},[S("div",void 0,{class:"egg_avatar"},[M((()=>o.value.avatarMediaUrl?S("img",void 0,{src:o.value.avatarMediaUrl,class:"egg_avatar_img",title:"用户头像",alt:"用户头像"}):S("div",void 0,{class:"egg_avatar_nick",title:"用户头像"},R(o.value.nick.substring(1,3))))),S("div",void 0,{title:`用户状态 (${a.value?"封禁":"正常"})`,class:M((()=>"egg_status"+(a.value?" deactive":" active")))})]),S("div",void 0,{class:"egg_nick",title:"用户昵称"},R(o.value.nick))]),S("button",void 0,{type:"button",class:"egg_logout_btn",onclick:L((()=>{te("logout",{type:"tab",id:t.value,data:null}),e.value=!1}),300)},R("退出"))]:void 0)),{onMounted(){_((()=>!e.value&&(o.value=null)))}})}():void 0)),ge(),le({text:"任务"}),Me(),le({text:"运行"}),S("div",void 0,{class:"egg_run_list"},[{title:"视频静音",tip:"视听学习时，静音播放视频",type:1}].map((e=>function({title:e,tip:t,checked:a,onchange:o}){return S("div",void 0,{class:"egg_setting_item"},[S("div",void 0,{class:"egg_label_wrap"},[S("label",void 0,{class:"egg_task_title"},[R(e),ue({tip:t})])]),de({tip:t,checked:a,onchange:o})])}({title:e.title,tip:e.tip,checked:M((()=>o[e.type])),onchange:L((t=>{((e,t,a)=>{const{checked:i}=e.target;o[t]!==i&&(o[t]=i,ne("settings",o),l({id:a,title:"设置",message:`${a} ${i?"打开":"关闭"}`}))})(t,e.type,e.title)}),300)})))),w((()=>[e.value,t.value]),(()=>e.value&&t.value?we():void 0)),he({settingsShow:r,settings:o,themeColor:a}),S("div",void 0,{class:"egg_footer_item"},[O({viewBox:"0 0 762 52.917",paths:["M0 0c22.863 0 40.637 25.93 63.5 25.93S104.137 0 127 0s40.637 25.93 63.5 25.93S231.137 0 254 0s40.637 25.93 63.5 25.93S358.137 0 381 0s40.637 25.93 63.5 25.93S485.137 0 508 0s40.637 25.93 63.5 25.93S612.137 0 635 0s40.637 25.93 63.5 25.93S739.137 0 762 0v52.917H0z"]}),O({viewBox:"0 0 762 52.917",paths:["M0 0c22.863 0 40.637 25.93 63.5 25.93S104.137 0 127 0s40.637 25.93 63.5 25.93S231.137 0 254 0s40.637 25.93 63.5 25.93S358.137 0 381 0s40.637 25.93 63.5 25.93S485.137 0 508 0s40.637 25.93 63.5 25.93S612.137 0 635 0s40.637 25.93 63.5 25.93S739.137 0 762 0v52.917H0z"]})])])}(),document.querySelector("#app"));
